#!/bin/bash
"""
Setup script for WindowsVM Kopf Operator
This script installs dependencies and provides instructions for running the operator
"""

echo "ðŸš€ WindowsVM Kopf Operator Setup"
echo "================================="

# Install Python dependencies
echo "ðŸ“¦ Installing Python dependencies..."
pip3 install -r kopf-requirements.txt

echo ""
echo "âœ… Setup completed!"
echo ""
echo "ðŸ“– Usage Instructions:"
echo "======================"
echo ""
echo "1. Run the operator locally:"
echo "   python3 kopf-manifest-controller.py"
echo ""
echo "2. In another terminal, test the operator:"
echo "   python3 test-kopf-operator.py"
echo ""
echo "3. Watch operator logs to see CR processing:"
echo "   # The operator will automatically detect WindowsVM CR changes"
echo "   # and run the corresponding Ansible playbooks"
echo ""
echo "ðŸŽ¯ Key Features:"
echo "â€¢ Automatic VM deployment when WindowsVM CRs are created"
echo "â€¢ VM updates when CR specs are modified"
echo "â€¢ VM cleanup when CRs are deleted"
echo "â€¢ Status monitoring and updates"
echo "â€¢ Event-driven processing with Kopf framework"
echo ""
echo "ðŸ”§ Configuration:"
echo "â€¢ CRD Group: infra.example.com"
echo "â€¢ CRD Version: v1"
echo "â€¢ Resource: windowsvms"
echo "â€¢ Namespace: default (configurable)"
echo ""
echo "ðŸ“‹ Operator Capabilities:"
echo "â€¢ @kopf.on.create - Handle CR creation"
echo "â€¢ @kopf.on.update - Handle CR updates" 
echo "â€¢ @kopf.on.delete - Handle CR deletion"
echo "â€¢ @kopf.timer - Monitor VM status periodically"
echo "â€¢ @kopf.on.field - React to specific field changes"
echo ""
